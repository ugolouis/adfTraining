{
	"name": "SQL script 1",
	"properties": {
		"content": {
			"query": "CREATE PROCEDURE DWH.usp_DropAllTablesAndProcedure\nAS\nBEGIN\n    SET NOCOUNT ON;\n    \n    BEGIN TRY\n        -- Drop the old stored procedure\n        IF OBJECT_ID('DWH.usp_CreateFactDimensionTables', 'P') IS NOT NULL\n        BEGIN\n            DROP PROCEDURE DWH.usp_CreateFactDimensionTables;\n            PRINT 'Dropped procedure DWH.usp_CreateFactDimensionTables';\n        END\n\n        -- Drop tables individually\n        IF OBJECT_ID('DWH.DimPatient', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimPatient;\n            PRINT 'Dropped table DWH.DimPatient';\n        END\n\n        IF OBJECT_ID('DWH.DimLocation', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimLocation;\n            PRINT 'Dropped table DWH.DimLocation';\n        END\n\n        IF OBJECT_ID('DWH.DimBed', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimBed;\n            PRINT 'Dropped table DWH.DimBed';\n        END\n\n        IF OBJECT_ID('DWH.DimChiefComplaint', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimChiefComplaint;\n            PRINT 'Dropped table DWH.DimChiefComplaint';\n        END\n\n        IF OBJECT_ID('DWH.DimEdAttendanceType', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimEdAttendanceType;\n            PRINT 'Dropped table DWH.DimEdAttendanceType';\n        END\n\n        IF OBJECT_ID('DWH.DimSpecialty', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimSpecialty;\n            PRINT 'Dropped table DWH.DimSpecialty';\n        END\n\n        IF OBJECT_ID('DWH.DimBreachReason', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimBreachReason;\n            PRINT 'Dropped table DWH.DimBreachReason';\n        END\n\n        IF OBJECT_ID('DWH.DimDischargeDestination', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimDischargeDestination;\n            PRINT 'Dropped table DWH.DimDischargeDestination';\n        END\n\n        IF OBJECT_ID('DWH.DimEdDepartmentType', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimEdDepartmentType;\n            PRINT 'Dropped table DWH.DimEdDepartmentType';\n        END\n\n        IF OBJECT_ID('DWH.FactPatientEdJourney', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.FactPatientEdJourney;\n            PRINT 'Dropped table DWH.FactPatientEdJourney';\n        END\n\n        IF OBJECT_ID('DWH.DimModeOfArrival', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimModeOfArrival;\n            PRINT 'Dropped table DWH.DimModeOfArrival';\n        END\n\n        IF OBJECT_ID('DWH.DimDischargeStatus', 'U') IS NOT NULL\n        BEGIN\n            DROP TABLE DWH.DimDischargeStatus;\n            PRINT 'Dropped table DWH.DimDischargeStatus';\n        END\n\n        PRINT 'All specified tables and the old stored procedure have been dropped successfully.';\n    END TRY\n    BEGIN CATCH\n        DECLARE @ErrorMessage NVARCHAR(4000) = ERROR_MESSAGE();\n        DECLARE @ErrorSeverity INT = ERROR_SEVERITY();\n        DECLARE @ErrorState INT = ERROR_STATE();\n        \n        PRINT 'Error occurred: ' + @ErrorMessage;\n        RAISERROR (@ErrorMessage, @ErrorSeverity, @ErrorState);\n    END CATCH\nEND;\nGO\n\n-- Execute the stored procedure to drop all tables and the old stored procedure\nEXEC DWH.usp_DropAllTablesAndProcedure;\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "taxi",
				"poolName": "taxi"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}